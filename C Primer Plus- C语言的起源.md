# C Primer Plus - C 语言的起源

### 1. 初识C语言

#### 1.1 C语言的起源

```
C语言的诞生就是为了让程序员设计开发
```



#### 1.2 选择C语言的理由（优点vs缺点）

##### 优点：

```C
// 在结构方面
1. 融合了计算机科学理论和实践的控制特征。
2. 易自顶向下的规划，结构化编程，模块化设计。
3. C语言编写的程序更易懂，可靠

//高效
 1. C程序充分发挥了计算机的优势，紧凑且运行速度快。
 2. C语言具有汇编语言才有的微调控制能力
    
//可移植性
 1. C语言可以放在其他系统中运行，只需要更改主程序头文件的少许项极客。
    IBM, PC, BASIC程序， 苹果BASIC程序， UNIX系统中运行的IBM大型机的FORTRAN程序。
    可用于多种计算机体系结构，只要有C编译器就可以。 //C编译器把C代码转化成计算机内部指令
 2. 有些操作系统会自带C编译器。很多操作系统都可以找到稳定的C编译器。
   
//强大灵活
 1. 操作系统、其他语言的编译器都是用C语言写的。

// 面向程序员的语言
 1. C可以访问硬件、操控内存。C更加自由，比C++的限制多。可能会犯一些莫名其妙的错误。
```

##### 缺点：

```
1. 想拥有自由就要时刻保持警惕,小心指针
2. C语言经常写出令人费解的代码
```



#### 1.3 C 语言的应用范围

1980年左右，小型计算机的UNIX系统是C语言的战场。从此以后，C语言的应用范围扩展到微型计算机和大型计算机。许多软件公司都用C来开发文字处理程序、电子表格、编译器和其他产品。或者嵌入式开发或者电影特效等等。

1990年，许多软件公司开始用C++ 开来发大型的变成项目。这是一种面向对象的工具，面向对象的编程是一门哲学，用建模适应问题，而不是从问题出发使用语言。



#### 1.4 计算机能做什么

介绍计算机的一些组件（CPU，RAM，永久存储设备，外围设备）

```
CPU就是从内存中获取并执行一条指令，然后再从内存中获取并执行下一条指令
CPU的寄存器：1. 有一个寄存器存储下一个指令的内存地址。
           2. 从该指令地址中获取指令，放在一个寄存器中存储指令。
           3. CPU能理解的指令非常有限(指令集)，这些指令相当具体，其中有很多都是把数字从一个位置去移动到另一个位置(内存移动寄存器)。
           
           4. 所有的指令集用数字表示，所有的存储数字和字符都用数字表示。
   
这些操作过于具体，以至于会产生大量的代码，好在机器语言编程的黄金时代已经一去不复返了。我们进入了高级编程语言的时代。      
```



#### 1.5 高级计算机语言和编译器

什么是编译器？

```
我们的思考： a=a+b;
机器的思考，我要把内存2000位置的数字放到寄存器1， 然后把内存2400位置的数字放到寄存器2，把两个寄存器相加的结果放在寄存器1，然后把寄存器1的数字放到内存2800

我们的思考和机器的思考是不一样的，编译器就是翻译！

编译器也把高级语言，翻译成不同CPU制造商使用的系统指令，使之可以在不同的机器上进行运行。
```



#### 1.6 语言标准

```
1987年，K&R提供的标准。
这里定义了C语言，却没有定义C库，C语言貌似比其他语言更依赖标准库
```

##### 1.6.1 第一个ANSI/ISOC标准（1990）

```C++
1989年公布的ANSI C定义了C语言和C标准库。这个版本称为C89或者C90。

很有趣的是，这个标准提出了C精神：
1. 信任程序员
2. 不要妨碍程序员做需要的事情
3. 保持语言精炼简单
4. 只提供一个方法执行一个操作
5. 让程序运行的更快，即使不能保证可移植性

//最后，C语言保持具体问题具体分析的原则，为目标计算机设定合适的操作。而不要强加一个抽象，一个统一的定义。
```



##### 1.6.2 C99标准（1994）

```
并不是为了添加新的特性，而是为了达到新的目标：
1. 支持国际化编程，提供多种方法处理国际字符集
2. 为了实践而解决明显的缺陷 (很多都是因为64bit处理器的现实使用问题而增添的标准)
3. 为了适应科学和工程项目的关键值计算，提高C的适应性，让C比FORTRAN更有竞争力
```



##### 1.6.3 C11标准（2011）

```
1.不那么强调信任程序员，为编程的安全担忧
2. 不应要求服务小型机市场的供应商支持目标环境中用不到的特性。
3. 我们要跟进新的技术，新标准添加了更多多处理的计算机
```



#### 1.7  使用C语言的7个步骤（C语言是编译型语言）

##### 1.7.1 第一步：定义程序的目标

```
动手写程序之前，要在脑中有清晰的思路：
要想自己要做什么、程序需要哪些信息、要进行那些控制和计算、程序应该报告什么样的信息。
```



##### 1.7.2 第二步：设计程序

```
考虑如何用程序实现自己的目标：
用户界面是什么样子、如何组织程序、目标用户是谁、用多长时间来完成这个程序？

接下来考虑：
用怎样的方式去合理表示信息。

要用术语描述而不仅仅局限于语言
```



##### 1.7.3 第三步： 编写代码

```
这才是真正需要了解C语言的地方，可以用文本编辑器来创建源代码。
//注意你的程序添加注释是非常必要的。
```



##### 1.7.4 第四步：编译

```
编译的细节取决于编译的环境，我们先了解编译做了什么：
编译过程就是把源代码->可执行代码的过程。（可执行代码就是机器语言表示的代码）

此外，C编译器把源代码与C库链接起来，合并成最终的程序。

编译器还会进行报错。
```



##### 1.7.5 第五步：运行程序

```
按照特定的执行环境进行执行。
```



##### 1.7.6 第六步： 测试和调试程序

```
查找和修复bug的地方叫做调试。请做好查bug的准备。
```



##### 1.7.7 第七步： 维护和修改代码

```
发现程序有错，或者想扩展程序的用途，或者你有更好的实现方案的方法就要修改程序。
```



##### 1.7.8 说明

```
初学者往往跳过1，2步骤而直接进行第3步骤的编写，请切记写文档的重要性。
不然，程序中隐藏的错误是非常难找的，往往跳过前两步的人浪费了更多的时间、
```



#### 1.8 编译机制 (重點)

```
常见的C环境：UNIX，Linux，MS—DOS，Windows，Macintosh OS。

写代码的文件叫做源文件(.c)。格式=基本名.扩展名=文件名
不同环境下的文件名命名方式有所不同
```



##### 1.8.1 目标代码文件、可执行文件和库

```C++
C编程的基本逻辑： 把源代码->可执行文件
C编译的过程=编译+链接
//中间文件：编译器把源代码转换成中间代码、链接器把中间代码和其他代码（或者预编译库中的代码）合并生成可执行文件。

用这种“编译+链接”的方法，C有效的进行分而治之，方便对程序进行模块化，可以独立编译单独的模块，稍后用链接器合并起来已编译的模块。只需要更改某个模块，不需要重新编译其他模块。

//目标文件：最普遍的就是把源代码转换成机器代码。
虽然目标文件中存储的是机器语言代码，但是不能直接运行该文件。因为这还是一个完整的程序。
    
//1. 目标代码不能执行的一个重要原因就是没有“启动代码”。启动代码充当程序和操作系统的接口。一切情况下，有可能目标代码相同但是启动代码不同。这是因为各个系统的程序处理方式是不同的。

//2. 目标代码缺少库函数。C标准库记录者常用的函数的目标代码。
    
//链接器： 把目标代码、启动代码和标准库的目标代码组装起来。
  有些时候需要分别运行编译程序和链接程序，但是在其他的系统中，编译器会自动启动链接器。
```



##### 1.8.2 UNIX系统

```C++
接下来，我们要了解一些具体的系统：

UNIX系统系列 (包括UNIX、FreeBSD等等)
UNIX上没有C自己的编辑器，但是可以使用UNIX编辑器，比如emacs,jove,vi,X Window System文本编辑器等等。
UNIX区分文件名字的大小写，在命名的时候应该注意。


//UNIX上的编辑器采用cc命令进行编译操作 
cc inform.c

这个时候编译就完成了(有可能会出现一些大大小小的错误，如果编译器报告void错误，那可能你的系统未更新成ANSIC编译器，只需要删除void即可)。这个时候会出现a.out文件，这个文件就是可执行文件了：
    
运行可执行文件是a.out (注意要给可执行文件进行重命名，不然容易被覆盖)
输出内容： ......
    
//对于目标文件： 会生成.o文件，有的时候没有，是因为链接器一旦生成了完整的可执行代码，就会删除中间代码。
但是如果原始程序有多个源代码，则保留目标代码。我猜测原因是如果代码有重用成分，那么不需要多次重复的编译。
```



##### 1.8.3 GNU编译器集合和LLVM项目

```C++
GNU是一个1987年创建的，是一个开发大量免费的UNIX软件的集合 (GNU is not UNIX)。 GNU编译器集合（也被叫做GCC）是该项目的产品之一。GCC有各种版本，以适应不同的硬件平台和操作系统，包括UNIX和LINUX，以及Windows。

LLVM项目是cc的另一个替代品。通过clang调用，有多个版本供不同的平台使用，包括Linux。Clang是FreeBSD默认的C编译器。

//如此看来，cc就是各个编译器的总称（实际操作的时候用gcc或者clang），查看编译器的版本格式为：
cc -v

//gcc和clang都可以根据不同的C标准去编译源文件:
例如：gcc -std=c99 inform.c   //采用c99 标准的格式
     gcc -std=c11 inform.c
```



##### 1.8.4 Linux系统

```
和UNIX差不多，不同的是要使用GNU提供的GCC公共域C编译器。
安装Linux的时候，要记得安装gcc哦
```



##### 1.8.5 PC的命令行编译器

```C++
//这里小小的注意一下：
C编译器不是Windows软件包的一部分，因此需要从别的地方获取并且安装C编译器。最常见的就是Cygwin 和 MinGW。这样便可以在PC上通过命令行使用GCC编译器。

//1. Cygwin有自己的视窗运行，模仿Linux环境，有一行命令提示。
//2. MinGW和Windows的cmd中运行。
    
注意源文件的保存是不能加字体格式的，也就是说要用txt或者Notepad来编辑源代码。
    
//Windows 和 Linux上的扩展名不同，中间文件的扩展是.obj。有些编译器还会生成.asm的汇编文件。有的编译器则有自己生成中间文件的格式。
    
//windows的可执行文件是.exe。
```



##### 1.8.6 集成开发环境（Windows）

```
伟大的集成开发环境IDE，大多数IDE都是C和C++的结合编译器。非常优秀

刚开始接触IDE的时候，有多个运行程序的多种环境：例如32位Windows程序，64位的Windows程序，动态链接库DLL。

所以会出现“项目”这个概念，我猜测相当于一个文件夹 (目录)，装源文件用的。这个时候就要创建各种文件，然后选择控制台应用程序去编译运行在不同的平台上：
 [Win32控制台应用程序]，[DOS EXE], [Console],[Character Mode]等等

一般来说，IDE既可以处理C，也可以处理C++。用扩展名区分C语言文件和C++文件。
```

```C++
//IDE出现的小问题
如果程序结束马上就会关闭，那么可以暂时让程序暂停，在return前面添加
    getchar()
这个时候程序运行到getchar()被阻塞，然后按下Enter键之后才会返回
```

**关于微软和C标准的兼容性**

```
Visual Studio支持C89/90，但是到目前为止微软是倾向于C++ 或者C#的。所以只是选择的支持那些在C++特性中能找到的C标准。2012年，VS不在把C作为项目类型的选项。但是大多数代码都可以用VS进行编译。
//使用VS去运行C标准的方法：
1. 新建项目的时候选择C++，然后选择Win32控制台应用程序，空项目，几乎所有的C都能和C++兼容。
2. 或者直接暴力的把扩展名改成.c，这样VS就会自动的去使用C语言的规则代替C++
```



##### 1.8.7 Windows/Linux

```
可以安装双系统，Windows 和Linux。只不过在两个系统运行的时候，不能用过Windows系统访问Linux文件，但是可以通过Linux系统访问Windows的文档
```



##### 1.8.8 Macintosh 中的C

```
MacOS时不时免费的Xcode可以作为IDE。可以选择不同的编程语言，包括C语言、

也需要创建项目，选择[OS X Application Command Line Tool],接着输入C类型。现在的MacOS都是默认clang去编译的，也可以用gcc。

注意：虽然MacOS有类似UNIX的界面，但是苹果在标准软件包中不提供命令行编译器。但是，如果下载了Xcode，还可以下载可选的命令行工具，这样就可以使用clang和gcc命令在命令行编译了。
```



#### 1.9 本书的组织结构：螺旋学习法



#### 1.10 本书的约定

##### 1.10.1 字体

##### 1.10.2 程序输入：粗体表输入，普通字体表输出

##### 1.10.3 特殊元素



#### 1.11 本章小结

#### 1.12 复习题目

#### 1.13 编程练习